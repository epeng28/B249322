---
title: "Exploring Trends of Salbutamol Prescriptions Across Scotland (2024)"
output: 
  html_document:
    theme: flatly
    toc: true
    toc_float: true
    code_folding: hide
date: "2025-10-31"
---

# Introduction
Salbutamol is a short acting β₂-adrenergic agonist used to provided acute relief of symptoms of asthma and chronic obstructive pulmonary disease (COPD). It is a widely prescribed drug, thus making it a useful indicator to make inferences on respiratory health and disease burden across Scotland. 

This report aims to explore seasonal, geographical and socioeconomic factors in Salbutamol prescription trends throughout Scotland in 2024, using prescribing data by NHS Scotland health board sourced from Public Health Scotland.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

```{r, message = FALSE}
library(tidyverse)
library(janitor)
library(gt)
library(here)
library(sf)
library(ggspatial)
library(patchwork)
```

```{r, message = FALSE}
# Data wrangling to produce a dataset only featuring data relating to bronchodilator prescriptions in Scotland.

# Filter the dataset, for bronchodilators using its BNF code (0301).
jantojun_2024 <- read_csv("https://www.opendata.nhs.scot/dataset/84393984-14e9-4b0d-a797-b288db64d088/resource/f0df380b-3f9b-4536-bb87-569e189b727a/download/hb_pitc2024_01_06-1.csv") %>% 
  clean_names() %>% 
  filter(str_starts(bnf_item_code, "0301"))

jultodec_2024 <- read_csv("https://www.opendata.nhs.scot/dataset/84393984-14e9-4b0d-a797-b288db64d088/resource/f3b9f2e2-66c0-4310-9b8e-734781d2ed0a/download/hb_pitc2024_07_12-1.csv") %>% 
  clean_names() %>% 
  filter(str_starts(bnf_item_code, "0301"))

# Combine the two datasets into one to cover the full year of 2024
data_2024 <- bind_rows(jantojun_2024, jultodec_2024)

# Read health board lookup table, and remove out old health board codes by keeping NA values for 'hb_date_archived'
hb_names <- read_csv(here("data", "hb14_hb19 (1).csv")) %>% 
  clean_names() %>% 
  filter(is.na(hb_date_archived))

# Assigns the names of the health boards to its corresponding HBT numeric code by joining with the health board look up table.
data_2024_with_names <- 
  full_join(hb_names, data_2024, by = c("hb" = "hbt")) %>% 
  filter(!is.na(hb_name))

# Exclude unneeded columns in the dataset.
bronchodilators_2024 <- data_2024_with_names %>% 
  select(-hb_date_enacted, -hb_date_archived, -country, -dmd_code)
```

# Section 1: How Commonly Used is Salbutamol in Relation to Other Bronchodilators?

```{r, message = FALSE}
# Assessing which bronchodilators are the most widely prescribed.

top5_bronchodilators <- bronchodilators_2024 %>% 
  select(bnf_item_description, number_of_paid_items) %>% 
  group_by(bnf_item_description) %>%
  summarise(paid_items_total = sum(number_of_paid_items)) %>% 
  slice_max(paid_items_total, n = 5)

# Creates a bar chart showing top 5 most prescribed bronchodilators.
count_plot <- top5_bronchodilators %>% 
  ggplot(aes(x= paid_items_total, 
             y= reorder(str_wrap(bnf_item_description, 
                                 width = 30),
                        paid_items_total))) +
  geom_col(fill = "steelblue") +
  labs(title = "Top 5 Most Prescribed Bronchodilators",
       subtitle = "Scotland (2024)",
       x = "Prescriptions Issued", 
       y = "Bronchodilator") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"))

count_plot
```

Figure 1. 

Based on the graph, Salbutamol-based drugs are dominant in this ranking, with ranks 1, 2 and 5 all representing formulations of Salbutamol. This highlights the widespread usage of Salbutamol in Scotland as well as suggesting a high prevalence of asthma and COPD in the country. It also reflects its role in first line therapy in the management of acute symptoms of asthma recommended by NICE (2025), and its usage as a short acting bronchodilator for breathlessness in COPD, as recommended by the NHS (2023).


